---
title : "Lec 11-3 : RNN Long sequence"
categories :
    - Deep_Learning_Study
tag :
    - [Deep_Learning_Study, RNN, long sequence]
toc : true
toc_sticky: true 
comments: true
sidebar_main: true
use_math: true
published: true
---

# 딥러닝 공부 27일차
<br>

## Sequence dataset from long sentence

<p align="center"><img src="/MYPICS/Deep_Learning/lec11-3/1.png" width = "700" ></p>

앞선 글에서는 문장을 커스터마이징 하는데까지 배워봤습니다. 

그렇다면 위 그림과 같이 긴 문장은 어떻게 rnn으로 학습시킬 수 있을까요??

사실 현직에서 사용하는 정도의 긴 문장은 절대 아니지만 아직 배운 수준에 비해선 긴 문장이니 그냥 그런거로 하겠습니다.

<p align="center"><img src="/MYPICS/Deep_Learning/lec11-3/2.png" width = "700" ></p>

x_data, y_data를 배열로 선언해줍니다.

반복문을 돌리는데, 우리는 긴 문장안에서 sequence_length 만큼씩 쪼개서 볼 겁니다.

예를들어 5개 글자중(공백포함) 시퀀스길이가 3이라면 5-3=2이므로 0부터2까지 3개의 반복문이 실행이 되는 것인데 이는 정확히 나눠서 세야할 반복 횟수와 동일합니다.

같은 원리로 
```py
for i in range(0, len(sentence) - sequence_length)
```
이렇게 표현이 되는 이유입니다.

긴 문장을 쪼개서 세주기 때문에 x_str에서 i번째 부터 i번째 + seqeunce_length 까지 슬라이싱해서 들어가게 됩니다.

마찬가지로 y는 예측값이자 출력값이므로 x보다 한글자씩 더 나아가야합니다. 그래서 +1이 붙습니다.

np.eye 함수로 원핫인코딩을 해줍니다. eye함수가 궁금하신 분들은 [eye함수 알아보러가기] 클릭해주세요

[eye함수 알아보러가기]:https://yuchulnote.github.io/deep_learning_study/QnA/#torchnniniteye_tensor

그리고 학습을 시켜야하므로 텐서로 변환해줍니다.

## FC layer and stacking RNN

<p align="center"><img src="/MYPICS/Deep_Learning/lec11-3/3.png" width = "700" ></p>
