---
title : "Lec 06: Softmax Classification"
categories :
    - Deep_Learning_Study
tag :
    - [Deep_Learning_Study, Classification, Softmax]
toc : true
toc_sticky: true
comments: true
sidebar_main: true
use_math: true
---

# 딥러닝 공부 7일차
## Softmax Classification
* Multinomial classification
<br>
<br>

### 원활한 이해를 위한 사전 지식들
#### One-hot encoding(원-핫 인코딩)

이전 글 까지는 Binary classificaiton, 즉 이분법적으로만 분류하는 것에 대해서 배웠습니다.

하지만 항상 이분법적으로만 생각할 수는 없죠, 이제는 여러가지를 고려하는 Multinomial classification에 대해서 배워볼겁니다.

이제 선택해야하는 선택지의 개수가 늘어남에 따라 필요한 것이 바로 원-핫 인코딩입니다.

원-핫 인코딩은 각 선택지의 인덱스에 해당하는 원소에는 1을, 나머지에는 0의 값을 가지도록 하는 표현 방법입니다.

예를들어볼까요?

우리 광운대학교 로봇학부 학생을 분류하는 프로그램이 있다고 해봅시다.

양재민 학생은 0번 인덱스, 박상현 학생은 1번 인덱스, 정유철 학생은 3번 인덱스를 부여했다고 해보면, 각 선택지에 대해서 원-핫 인코딩 된 벡터는

```py
양재민 = [1,0,0]
박상현 = [0,1,0]
정유철 = [0,0,1]
```

이와 같이 원-핫 인코딩으로 표현된 벡터를 **One-hot vector(원-핫 벡터)** 라고 합니다.

##### 원-핫 벡터를 사용하는 이유

분류하는 대상간에 상관성이 있다면 말이 달라지겠지만, 상관성이 없이 분류만 필요한 상황이라고 생각해봅시다.

만약 원-핫 인코딩을 하지않고, 정수로 이루어진 벡터를 사용한다면 어떻게 될까요?

다시 예를들어 {양재민, 박상현, 이재원}이 {0,1,2}로 레이블이 된다면
손실 함수로 선형 회귀 챕터에서 배운 평균 제곱 오차, MSE를 통해 정수 인코딩이 어떤 오해를 불러일으키는지 확인할 수 있습니다.

$\hat{y}$은 예측값을 의미합니다.

$$
Loss\ function = \frac{1}{n} \sum_i^{n} \left(y_{i} - \hat{y_{i}}\right)^2
$$

실제 값이 상현이일때, 예측값이 재민이였다면 제곱 오차는 다음과 같습니다.
$(2-1)^2=1$

실제 값이 재원이일때, 예측값이 재민이였다면 제곱 오차는 다음과 같습니다.
$(3-1)^2=4$

즉, 재민이와 상현이 사이의 오차보다 재민이와 재원이의 오차가 더 큽니다.

**이는 기계에게 재민이가 재원이보다 상현이와 더 비슷하다라는 정보를 주는 것과 다름없습니다.**

ㅋㅋㅋㅋ

이러면 안되겠지요~

이런 정수 인코딩이 3개가아니라 몇십개 몇백개라면, 그 제곱의 크기는 더욱더 커질 것입니다.

그래서 단순 분류를 해야하는 multinomial classification 에서는 각 클래스간의 제곱오차를 균등하게 만들어주기 위해서 원-핫 인코딩을 사용합니다.

만약 클래스간의 연관성이 있는 {10대,20대,30대,40대...} 혹은 {유년기,청소년기, 성년기, 노년기} 등.. 이런 부류에서는 정수 인코딩이 필요할 수 있습니다.
<br>

#### Discrete Probability Distribution(이산 확률 분포)

고등학교 때 수학시간에 배웠던 연속 확률 분포와 반대점에 있는 것이 이산 확률 분포입니다.

가장 대표적인 예로 주사위의 한 눈금이 나올 확률을 예로 들 수 있겠습니다.

주사위의 눈금 1이 나올 확률 = $\frac{1}{6}$
주사위의 눈금 2이 나올 확률 = $\frac{1}{6}$
주사위의 눈금 3이 나올 확률 = $\frac{1}{6}$
주사위의 눈금 4이 나올 확률 = $\frac{1}{6}$
주사위의 눈금 5이 나올 확률 = $\frac{1}{6}$
주사위의 눈금 6이 나올 확률 = $\frac{1}{6}$

설마 방금 던진 주사위의 눈금이 2였다고 그 다음에 주사위를 던질 때 주사위가 2보단 다른 숫자가 나올 확률이 높다고 생각하시는 분들은 없겠죠??

이처럼 이산확률분포는 연속적인 그래프가 아닌 
<p align="center"><img src="/MYPICS/lec06/1.png" width = "300" ></p>

[사진출처]

[사진출처]:https://nittaku.tistory.com/454

이런식으로 불연속적인 함수를 보이는 것이 특징이고, 모든 확률의 합은 1인 특징을 갖고 있습니다.
<br>
<br>

### Multinomial Classification

